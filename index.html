<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Super Central de Sites Premium</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-gradient: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            --secondary-gradient: linear-gradient(135deg, #00bcd4 0%, #00e676 100%);
            --danger-gradient: linear-gradient(135deg, #ff416c 0%, #ff4b2b 100%);
            --warning-gradient: linear-gradient(135deg, #f7971e 0%, #ffd200 100%);
            --dark-gradient: linear-gradient(135deg, #2c3e50 0%, #4ca1af 100%);
            
            --primary-color: #6a11cb;
            --secondary-color: #00bcd4;
            --success-color: #00e676;
            --danger-color: #ff416c;
            --warning-color: #f7971e;
            --info-color: #2196f3;
            --dark-color: #2c3e50;
            --light-color: #f5f7fa;
            
            --text-color: #ffffff;
            --text-secondary: rgba(255, 255, 255, 0.7);
            --text-dark: #333333;
            
            --card-bg: rgba(255, 255, 255, 0.15);
            --card-hover: rgba(255, 255, 255, 0.25);
            --container-bg: rgba(255, 255, 255, 0.08);
            --input-bg: rgba(255, 255, 255, 0.95);
            --modal-bg: rgba(0, 0, 0, 0.8);
            
            --shadow-light: rgba(0, 0, 0, 0.1);
            --shadow-medium: rgba(0, 0, 0, 0.2);
            --shadow-dark: rgba(0, 0, 0, 0.3);
            
            --border-radius-sm: 8px;
            --border-radius-md: 12px;
            --border-radius-lg: 16px;
            --border-radius-xl: 20px;
            --border-radius-circle: 50%;
            
            --transition-fast: 0.2s ease;
            --transition-medium: 0.3s ease;
            --transition-slow: 0.5s ease;
            
            --spacing-xs: 5px;
            --spacing-sm: 10px;
            --spacing-md: 15px;
            --spacing-lg: 20px;
            --spacing-xl: 30px;
            --spacing-xxl: 40px;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: var(--primary-gradient);
            color: var(--text-color);
            min-height: 100vh;
            line-height: 1.6;
            overflow-x: hidden;
            position: relative;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at 20% 30%, rgba(106, 17, 203, 0.3) 0%, transparent 40%),
                        radial-gradient(circle at 80% 70%, rgba(37, 117, 252, 0.3) 0%, transparent 40%);
            z-index: -1;
            pointer-events: none;
        }

        /* Layout */
        .app-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: var(--spacing-xl);
            display: flex;
            flex-direction: column;
            gap: var(--spacing-xxl);
        }

        .header {
            text-align: center;
            margin-bottom: var(--spacing-lg);
        }

        .main-title {
            font-size: 3.5rem;
            font-weight: 800;
            margin-bottom: var(--spacing-sm);
            background: linear-gradient(to right, #fff, #c9d6ff);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            letter-spacing: -1px;
        }

        .subtitle {
            font-size: 1.2rem;
            color: var(--text-secondary);
            font-weight: 400;
            max-width: 700px;
            margin: 0 auto;
        }

        /* Cards Container */
        .card-container {
            background-color: var(--container-bg);
            border-radius: var(--border-radius-xl);
            padding: var(--spacing-xxl);
            box-shadow: 0 15px 40px var(--shadow-dark);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .section-title {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: var(--spacing-xl);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--spacing-sm);
        }

        .section-title i {
            font-size: 1.8rem;
        }

        /* Formul√°rio */
        .form-add-site {
            display: grid;
            grid-template-columns: 1fr 1fr auto;
            gap: var(--spacing-lg);
            margin-bottom: var(--spacing-xl);
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-xs);
        }

        .form-label {
            font-size: 0.9rem;
            color: var(--text-secondary);
            font-weight: 500;
            margin-left: var(--spacing-sm);
        }

        .form-input {
            padding: var(--spacing-md) var(--spacing-lg);
            border: none;
            border-radius: var(--border-radius-lg);
            background-color: var(--input-bg);
            color: var(--text-dark);
            font-size: 1rem;
            box-shadow: inset 0 2px 5px var(--shadow-light);
            transition: all var(--transition-medium);
            width: 100%;
        }

        .form-input:focus {
            outline: none;
            box-shadow: 0 0 0 3px var(--secondary-color), inset 0 2px 5px var(--shadow-light);
        }

        .form-select {
            appearance: none;
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right var(--spacing-md) center;
            background-size: 1rem;
        }

        .btn {
            padding: var(--spacing-md) var(--spacing-xl);
            border: none;
            border-radius: var(--border-radius-lg);
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all var(--transition-medium);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: var(--spacing-sm);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .btn-primary {
            background: var(--secondary-gradient);
            color: white;
            box-shadow: 0 5px 15px rgba(0, 188, 212, 0.4);
            align-self: flex-end;
        }

        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0, 188, 212, 0.6);
        }

        .btn-primary:active {
            transform: translateY(1px);
        }

        /* Grid de Sites */
        .sites-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            gap: var(--spacing-lg);
            width: 100%;
        }

        .site-card {
            background-color: var(--card-bg);
            border-radius: var(--border-radius-lg);
            padding: var(--spacing-xl);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            cursor: pointer;
            transition: all var(--transition-medium);
            box-shadow: 0 6px 20px var(--shadow-light);
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.1);
            animation: fadeIn 0.5s ease-out;
            user-select: none; /* Prevent text selection on long press */
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
        }

        .site-card::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(
                to bottom right,
                rgba(255, 255, 255, 0) 0%,
                rgba(255, 255, 255, 0) 50%,
                rgba(255, 255, 255, 0.1) 50%,
                rgba(255, 255, 255, 0.1) 100%
            );
            transform: rotate(30deg);
            transition: all var(--transition-slow);
            opacity: 0;
        }

        .site-card:hover {
            transform: translateY(-8px);
            background-color: var(--card-hover);
            box-shadow: 0 12px 30px var(--shadow-dark);
        }

        .site-card:hover::before {
            animation: shine 3s infinite;
            opacity: 1;
        }

        @keyframes shine {
            0% {
                transform: rotate(30deg) translate(-30%, -30%);
            }
            100% {
                transform: rotate(30deg) translate(30%, 30%);
            }
        }

        .site-card.fade-out {
            animation: fadeOut 0.5s ease-out forwards;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes fadeOut {
            from { opacity: 1; transform: translateY(0); }
            to { opacity: 0; transform: translateY(20px); }
        }

        .site-card .site-link { /* Changed from a to site-link class */
            color: inherit;
            text-decoration: none;
            font-weight: 600;
            font-size: 1.2rem;
            margin-top: var(--spacing-md);
            word-break: break-word;
            width: 100%;
            transition: color var(--transition-fast);
            display: block; /* Make the link take full width */
            pointer-events: none; /* Prevent direct link click for primary action */
        }

        .site-card:hover .site-link {
            color: var(--secondary-color);
        }

        .site-card .card-actions {
            position: absolute;
            top: var(--spacing-sm);
            right: var(--spacing-sm);
            display: flex;
            gap: var(--spacing-xs);
            opacity: 0;
            transition: opacity var(--transition-medium);
            pointer-events: none; /* Default to non-interactive */
        }

        .site-card.show-actions .card-actions { /* New class for showing actions */
            opacity: 1;
            pointer-events: auto;
        }
        
        /* Ensure actions are always visible on hover if you prefer, or manage only via JS */
        /* .site-card:hover .card-actions {
            opacity: 1;
            pointer-events: auto;
        } */


        .action-btn {
            background: rgba(0, 0, 0, 0.3);
            border: none;
            color: var(--text-color);
            width: 30px;
            height: 30px;
            border-radius: var(--border-radius-circle);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all var(--transition-fast);
        }

        .action-btn:hover {
            transform: scale(1.1);
        }

        .btn-remove:hover {
            background: var(--danger-gradient);
            color: white;
        }

        .btn-edit:hover {
            background: var(--warning-gradient);
            color: white;
        }

        .btn-pin:hover {
            background: var(--dark-gradient);
            color: white;
        }

        .site-icon {
            width: 70px;
            height: 70px;
            border-radius: var(--border-radius-circle);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            font-weight: 700;
            color: #fff;
            margin-bottom: var(--spacing-md);
            background-color: rgba(255, 255, 255, 0.25);
            box-shadow: 0 4px 10px var(--shadow-light);
            overflow: hidden;
            position: relative;
            flex-shrink: 0; /* Prevent icon from shrinking */
        }

        .site-icon img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
        }

        .site-icon .icon-fallback {
            position: absolute;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: rgba(0, 0, 0, 0.2);
        }

        .site-category {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            padding: var(--spacing-xs) 0;
            background: rgba(0, 0, 0, 0.3);
            font-size: 0.7rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* Categorias */
        .categories-container {
            display: flex;
            gap: var(--spacing-sm);
            margin-bottom: var(--spacing-xl);
            flex-wrap: wrap;
            justify-content: center;
        }

        .category-filter {
            padding: var(--spacing-xs) var(--spacing-md);
            border-radius: var(--border-radius-lg);
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: var(--text-color);
            cursor: pointer;
            transition: all var(--transition-fast);
            font-size: 0.9rem;
        }

        .category-filter:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .category-filter.active {
            background: var(--secondary-color);
            font-weight: 600;
        }

        /* Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--modal-bg);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            pointer-events: none;
            transition: opacity var(--transition-medium);
            backdrop-filter: blur(5px);
        }

        .modal-overlay.active {
            opacity: 1;
            pointer-events: all;
        }

        .modal-content {
            background: var(--primary-gradient);
            border-radius: var(--border-radius-xl);
            padding: var(--spacing-xxl);
            width: 90%;
            max-width: 500px;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
            transform: translateY(20px);
            transition: transform var(--transition-medium);
            position: relative;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .modal-overlay.active .modal-content {
            transform: translateY(0);
        }

        .modal-close {
            position: absolute;
            top: var(--spacing-lg);
            right: var(--spacing-lg);
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: 1.5rem;
            cursor: pointer;
            transition: color var(--transition-fast);
        }

        .modal-close:hover {
            color: var(--danger-color);
        }

        .modal-title {
            font-size: 1.8rem;
            margin-bottom: var(--spacing-xl);
            text-align: center;
        }

        /* Notifica√ß√µes */
        .notification-container {
            position: fixed;
            top: var(--spacing-xl);
            right: var(--spacing-xl);
            z-index: 1000;
            display: flex;
            flex-direction: column;
            gap: var(--spacing-sm);
        }

        .notification {
            background-color: rgba(0, 0, 0, 0.8);
            color: white;
            padding: var(--spacing-md) var(--spacing-lg);
            border-radius: var(--border-radius-md);
            box-shadow: 0 4px 15px var(--shadow-dark);
            opacity: 0;
            transform: translateX(100%);
            animation: slideIn 0.4s forwards, fadeOutNotification 3s forwards 2.5s;
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
            border-left: 4px solid;
            max-width: 350px;
        }

        .notification-success {
            border-left-color: var(--success-color);
        }

        .notification-error {
            border-left-color: var(--danger-color);
        }

        .notification-warning {
            border-left-color: var(--warning-color);
        }

        .notification-info {
            border-left-color: var(--info-color);
        }

        .notification i {
            font-size: 1.5rem;
        }

        @keyframes slideIn {
            to { opacity: 1; transform: translateX(0); }
        }

        @keyframes fadeOutNotification {
            from { opacity: 1; }
            to { opacity: 0; transform: translateX(100%); }
        }

        /* Empty State */
        .empty-state {
            grid-column: 1 / -1; /* Make it span all columns in the grid */
            text-align: center;
            padding: var(--spacing-xxl) 0;
            color: var(--text-secondary);
        }

        .empty-state i {
            font-size: 3rem;
            margin-bottom: var(--spacing-md);
            opacity: 0.5;
        }

        .empty-state p {
            font-size: 1.1rem;
        }

        /* Pinned Sites */
        .pinned-sites {
            margin-bottom: var(--spacing-xxl);
        }

        .pinned-sites .sites-grid {
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
        }

        .pinned-sites .site-card {
            border: 2px solid var(--warning-color);
        }

        /* Search Bar */
        .search-container {
            margin-bottom: var(--spacing-xl);
            position: relative;
        }

        .search-input {
            width: 100%;
            padding: var(--spacing-md) var(--spacing-lg);
            padding-left: 50px;
            border: none;
            border-radius: var(--border-radius-lg);
            background-color: var(--input-bg);
            color: var(--text-dark);
            font-size: 1rem;
            box-shadow: 0 4px 15px var(--shadow-light);
            transition: all var(--transition-medium);
        }

        .search-input:focus {
            outline: none;
            box-shadow: 0 0 0 3px var(--secondary-color), 0 4px 15px var(--shadow-light);
        }

        .search-icon {
            position: absolute;
            left: var(--spacing-lg);
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-dark);
        }

        /* Responsividade */
        @media (max-width: 992px) {
            .main-title {
                font-size: 2.8rem;
            }
            
            .form-add-site {
                grid-template-columns: 1fr;
            }
            
            .sites-grid {
                grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            }
        }

        @media (max-width: 768px) {
            .app-container {
                padding: var(--spacing-lg);
            }
            
            .main-title {
                font-size: 2.2rem;
            }
            
            .subtitle {
                font-size: 1rem;
            }
            
            .card-container {
                padding: var(--spacing-xl);
            }
            
            .section-title {
                font-size: 1.5rem;
            }
        }

        @media (max-width: 576px) {
            .main-title {
                font-size: 1.8rem;
            }
            
            .card-container {
                padding: var(--spacing-lg);
            }
            
            .site-card {
                padding: var(--spacing-lg);
            }
            
            .site-icon {
                width: 50px;
                height: 50px;
                font-size: 1.5rem;
            }
            
            .modal-content {
                padding: var(--spacing-xl) var(--spacing-lg);
            }
        }

        /* Dark Mode Toggle */
        .theme-toggle {
            position: fixed;
            bottom: var(--spacing-xl);
            right: var(--spacing-xl);
            width: 50px;
            height: 50px;
            border-radius: var(--border-radius-circle);
            background: var(--dark-gradient);
            color: white;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            z-index: 100;
            transition: all var(--transition-medium);
        }

        .theme-toggle:hover {
            transform: scale(1.1) rotate(30deg);
        }

        /* Stats */
        .stats-container {
            display: flex;
            gap: var(--spacing-lg);
            margin-bottom: var(--spacing-xl);
            flex-wrap: wrap;
            justify-content: center;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: var(--border-radius-lg);
            padding: var(--spacing-lg);
            min-width: 150px;
            text-align: center;
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: var(--spacing-xs);
            background: linear-gradient(to right, #fff, #c9d6ff);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        .stat-label {
            font-size: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--text-secondary);
        }

        /* Animations */
        @keyframes float {
            0%, 100% {
                transform: translateY(0);
            }
            50% {
                transform: translateY(-10px);
            }
        }

        .floating {
            animation: float 3s ease-in-out infinite;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
        }

        ::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.3);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.5);
        }
    </style>
</head>
<body>
    <div class="notification-container" id="notification-container"></div>
    
    <button class="theme-toggle" id="theme-toggle">
        <i class="fas fa-moon"></i>
    </button>

    <div class="app-container">
        <header class="header">
            <h1 class="main-title floating">Super Central de Sites</h1>
            <p class="subtitle">Organize todos os seus sites favoritos em um s√≥ lugar com estilo e praticidade</p>
        </header>

        <div class="card-container">
            <div class="search-container">
                <i class="fas fa-search search-icon"></i>
                <input type="text" class="search-input" id="search-input" placeholder="Pesquisar sites...">
            </div>

            <div class="stats-container">
                <div class="stat-card">
                    <div class="stat-value" id="total-sites">0</div>
                    <div class="stat-label">Sites Totais</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="pinned-sites-count">0</div> <div class="stat-label">Fixados</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="categories-count">0</div>
                    <div class="stat-label">Categorias</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="last-added">-</div>
                    <div class="stat-label">√öltimo Adicionado</div>
                </div>
            </div>

            <h2 class="section-title">
                <i class="fas fa-plus-circle"></i>
                Adicionar Novo Site
            </h2>
            
            <form id="add-site-form" class="form-add-site">
                <div class="form-group">
                    <label for="site-name" class="form-label">Nome do Site</label>
                    <input type="text" id="site-name" class="form-input" placeholder="Ex: Google" required>
                </div>
                
                <div class="form-group">
                    <label for="site-url" class="form-label">URL do Site</label>
                    <input type="text" id="site-url" class="form-input" placeholder="Ex: https://google.com" required>
                </div>
                
                <div class="form-group">
                    <label for="site-category" class="form-label">Categoria</label>
                    <select id="site-category" class="form-input form-select">
                        <option value="geral">Geral</option>
                        <option value="trabalho">Trabalho</option>
                        <option value="estudo">Estudo</option>
                        <option value="entretenimento">Entretenimento</option>
                        <option value="redes-sociais">Redes Sociais</option>
                        <option value="outros">Outros</option>
                    </select>
                </div>
                
                <button type="submit" class="btn btn-primary">
                    <i class="fas fa-plus"></i>
                    Adicionar
                </button>
            </form>
        </div>

        <div class="card-container pinned-sites" id="pinned-container">
            <h2 class="section-title">
                <i class="fas fa-thumbtack"></i>
                Sites Fixados
            </h2>
            <div class="sites-grid" id="pinned-sites-container">
                <div class="empty-state">
                    <i class="fas fa-thumbtack"></i>
                    <p>Nenhum site fixado ainda. Clique no √≠cone de alfinete para fixar um site, ou pressione e segure no site para ver as a√ß√µes.</p>
                </div>
            </div>
        </div>

        <div class="card-container">
            <h2 class="section-title">
                <i class="fas fa-star"></i>
                Todos os Sites
            </h2>
            
            <div class="categories-container" id="categories-filter">
                <div class="category-filter active" data-category="all">Todos</div>
                <div class="category-filter" data-category="geral">Geral</div>
                <div class="category-filter" data-category="trabalho">Trabalho</div>
                <div class="category-filter" data-category="estudo">Estudo</div>
                <div class="category-filter" data-category="entretenimento">Entretenimento</div>
                <div class="category-filter" data-category="redes-sociais">Redes Sociais</div>
                <div class="category-filter" data-category="outros">Outros</div>
            </div>
            
            <div class="sites-grid" id="sites-container">
                <div class="empty-state">
                    <i class="fas fa-bookmark"></i>
                    <p>Nenhum site salvo ainda. Adicione seus favoritos acima!</p>
                </div>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="edit-modal">
        <div class="modal-content">
            <button class="modal-close" id="modal-close">
                <i class="fas fa-times"></i>
            </button>
            <h3 class="modal-title">Editar Site</h3>
            
            <form id="edit-site-form">
                <div class="form-group">
                    <label for="edit-site-name" class="form-label">Nome do Site</label>
                    <input type="text" id="edit-site-name" class="form-input" required>
                </div>
                
                <div class="form-group">
                    <label for="edit-site-url" class="form-label">URL do Site</label>
                    <input type="text" id="edit-site-url" class="form-input" required>
                </div>
                
                <div class="form-group">
                    <label for="edit-site-category" class="form-label">Categoria</label>
                    <select id="edit-site-category" class="form-input form-select">
                        <option value="geral">Geral</option>
                        <option value="trabalho">Trabalho</option>
                        <option value="estudo">Estudo</option>
                        <option value="entretenimento">Entretenimento</option>
                        <option value="redes-sociais">Redes Sociais</option>
                        <option value="outros">Outros</option>
                    </select>
                </div>
                
                <input type="hidden" id="edit-site-id">
                
                <button type="submit" class="btn btn-primary" style="width: 100%; margin-top: var(--spacing-md);">
                    <i class="fas fa-save"></i>
                    Salvar Altera√ß√µes
                </button>
            </form>
        </div>
    </div>

    <script>
        // Elementos DOM
        const addSiteForm = document.getElementById('add-site-form');
        const siteNameInput = document.getElementById('site-name');
        const siteUrlInput = document.getElementById('site-url');
        const siteCategoryInput = document.getElementById('site-category');
        const sitesContainer = document.getElementById('sites-container');
        const pinnedSitesContainer = document.getElementById('pinned-sites-container');
        const notificationContainer = document.getElementById('notification-container');
        const searchInput = document.getElementById('search-input');
        const categoriesFilter = document.getElementById('categories-filter');
        const editModal = document.getElementById('edit-modal');
        const editForm = document.getElementById('edit-site-form');
        const editNameInput = document.getElementById('edit-site-name');
        const editUrlInput = document.getElementById('edit-site-url');
        const editCategoryInput = document.getElementById('edit-site-category');
        const editSiteIdInput = document.getElementById('edit-site-id');
        const modalClose = document.getElementById('modal-close');
        const themeToggle = document.getElementById('theme-toggle');
        const totalSitesEl = document.getElementById('total-sites');
        const pinnedSitesCountEl = document.getElementById('pinned-sites-count'); // Corrected ID
        const categoriesCountEl = document.getElementById('categories-count');
        const lastAddedEl = document.getElementById('last-added');
        const pinnedContainer = document.getElementById('pinned-container');

        // Vari√°veis de estado
        let currentSites = [];
        let currentFilter = 'all';
        let currentSearch = '';
        let editSiteId = null;
        let pressTimer; // Timer for long press detection
        const LONG_PRESS_THRESHOLD = 500; // ms

        // Inicializa√ß√£o
        document.addEventListener('DOMContentLoaded', () => {
            loadSites();
            setupEventListeners();
            updateStats();
        });

        // Configura listeners
        function setupEventListeners() {
            // Formul√°rio de adi√ß√£o
            addSiteForm.addEventListener('submit', function(event) {
                event.preventDefault();
                addSite();
            });

            // Pesquisa
            searchInput.addEventListener('input', function() {
                currentSearch = this.value.toLowerCase();
                filterSites();
            });

            // Filtros de categoria
            categoriesFilter.addEventListener('click', function(e) {
                if (e.target.classList.contains('category-filter')) {
                    document.querySelectorAll('.category-filter').forEach(btn => {
                        btn.classList.remove('active');
                    });
                    e.target.classList.add('active');
                    currentFilter = e.target.dataset.category;
                    filterSites();
                }
            });

            // Modal
            modalClose.addEventListener('click', closeModal);
            editModal.addEventListener('click', function(e) {
                if (e.target === editModal) {
                    closeModal();
                }
            });
            editForm.addEventListener('submit', function(e) {
                e.preventDefault();
                saveEditedSite();
            });

            // Tema dark/light
            themeToggle.addEventListener('click', toggleTheme);

            // Verifica se h√° um tema salvo
            const savedTheme = localStorage.getItem('theme') || 'dark';
            document.body.classList.add(savedTheme + '-theme');
            updateThemeToggle(savedTheme);

            // Close actions when clicking outside (not on a site card or action)
            document.addEventListener('click', (event) => {
                if (!event.target.closest('.site-card')) {
                    hideAllSiteActions();
                }
            });
        }

        // Carrega os sites do localStorage
        function loadSites() {
            const sitesString = localStorage.getItem('mySites');
            currentSites = sitesString ? JSON.parse(sitesString) : [];
            
            renderAllSites();
            updateStats();
        }

        // Renderiza todos os sites
        function renderAllSites() {
            filterSites(); // Use filterSites to handle rendering based on current filters and search
        }

        // Renderiza sites em um container espec√≠fico
        function renderSites(sites, container, isEmptyStateForFiltered = false) {
            container.innerHTML = ''; // Clear previous content

            if (sites.length === 0) {
                const emptyState = document.createElement('div');
                emptyState.classList.add('empty-state');

                if (container.id === 'pinned-sites-container') {
                    emptyState.innerHTML = `
                        <i class="fas fa-thumbtack"></i>
                        <p>Nenhum site fixado ainda. Pressione e segure em um site para ver as a√ß√µes e fixar.</p>
                    `;
                } else if (isEmptyStateForFiltered) { // For filtered/searched results
                    emptyState.innerHTML = `
                        <i class="fas fa-search"></i>
                        <p>Nenhum site encontrado com os filtros atuais.</p>
                    `;
                } else { // Initial empty state for all sites
                    emptyState.innerHTML = `
                        <i class="fas fa-bookmark"></i>
                        <p>Nenhum site salvo ainda. Adicione seus favoritos acima!</p>
                    `;
                }
                container.appendChild(emptyState);
                return;
            }

            sites.forEach(site => {
                const siteCard = createSiteCard(site);
                container.appendChild(siteCard);
            });
        }

        // Cria um card de site
        function createSiteCard(site) {
            const siteCard = document.createElement('div');
            siteCard.classList.add('site-card');
            if (site.pinned) siteCard.classList.add('pinned');
            
            // Gera um ID √∫nico se n√£o existir (para compatibilidade com vers√µes antigas)
            if (!site.id) {
                site.id = 'site-' + Date.now() + Math.floor(Math.random() * 1000);
                saveAllSites(); // Atualiza no localStorage
            }
            
            // √çcone do site
            const siteIcon = document.createElement('div');
            siteIcon.classList.add('site-icon');
            
            // Tenta carregar o favicon
            const faviconUrl = `https://t1.gstatic.com/faviconV2?url=${encodeURIComponent(site.url)}&size=64`;
            const img = new Image();
            img.src = faviconUrl;

            // Immediate fallback while favicon loads
            const firstLetter = site.name.charAt(0).toUpperCase();
            siteIcon.innerHTML = `<div class="icon-fallback">${firstLetter}</div>`;

            img.onload = () => {
                siteIcon.innerHTML = ''; // Clear fallback if loaded
                siteIcon.appendChild(img);
            };
            img.onerror = () => {
                // Keep fallback, no need to re-assign
            };
            
            // Nome do site (now a simple span that acts as a link on click)
            const siteNameDisplay = document.createElement('span'); // Changed to span
            siteNameDisplay.classList.add('site-link'); // Added site-link class
            siteNameDisplay.textContent = site.name;
            siteNameDisplay.title = site.url; // Use title for hover tooltip
            
            // A√ß√µes do card
            const cardActions = document.createElement('div');
            cardActions.classList.add('card-actions');
            
            // Bot√£o de fixar
            const pinBtn = document.createElement('button');
            pinBtn.classList.add('action-btn', 'btn-pin');
            pinBtn.title = site.pinned ? 'Desfixar' : 'Fixar';
            pinBtn.innerHTML = `<i class="fas ${site.pinned ? 'fa-thumbtack' : 'fa-thumbtack'}"></i>`;
            pinBtn.addEventListener('click', (e) => {
                e.stopPropagation(); // Prevent card click
                togglePinSite(site.id);
                hideSiteActions(siteCard); // Hide actions after use
            });
            
            // Bot√£o de editar
            const editBtn = document.createElement('button');
            editBtn.classList.add('action-btn', 'btn-edit');
            editBtn.title = 'Editar';
            editBtn.innerHTML = '<i class="fas fa-edit"></i>';
            editBtn.addEventListener('click', (e) => {
                e.stopPropagation(); // Prevent card click
                openEditModal(site);
                hideSiteActions(siteCard); // Hide actions after use
            });
            
            // Bot√£o de remover
            const removeBtn = document.createElement('button');
            removeBtn.classList.add('action-btn', 'btn-remove');
            removeBtn.title = 'Remover';
            removeBtn.innerHTML = '<i class="fas fa-trash"></i>';
            removeBtn.addEventListener('click', (e) => {
                e.stopPropagation(); // Prevent card click
                removeSite(site.id, siteCard);
                hideSiteActions(siteCard); // Hide actions after use
            });
            
            // Categoria
            const categoryBadge = document.createElement('div');
            categoryBadge.classList.add('site-category');
            categoryBadge.textContent = getCategoryName(site.category || 'geral');
            
            // Monta o card
            cardActions.appendChild(pinBtn);
            cardActions.appendChild(editBtn);
            cardActions.appendChild(removeBtn);
            
            siteCard.appendChild(cardActions);
            siteCard.appendChild(siteIcon);
            siteCard.appendChild(siteNameDisplay);
            siteCard.appendChild(categoryBadge);
            
            // Event listeners for click/hold
            let isLongPress = false;

            siteCard.addEventListener('mousedown', (e) => {
                if (e.button === 0) { // Left click
                    pressTimer = setTimeout(() => {
                        isLongPress = true;
                        hideAllSiteActions(); // Hide other actions
                        siteCard.classList.add('show-actions'); // Show actions for THIS card
                    }, LONG_PRESS_THRESHOLD);
                }
            });

            siteCard.addEventListener('mouseup', (e) => {
                clearTimeout(pressTimer);
                if (!isLongPress && e.button === 0) { // If not long press and left click
                    window.open(site.url, '_blank');
                }
                isLongPress = false;
            });

            siteCard.addEventListener('mouseleave', () => {
                clearTimeout(pressTimer);
                isLongPress = false;
            });

            // For mobile touch events
            siteCard.addEventListener('touchstart', (e) => {
                pressTimer = setTimeout(() => {
                    isLongPress = true;
                    hideAllSiteActions();
                    siteCard.classList.add('show-actions');
                }, LONG_PRESS_THRESHOLD);
            }, { passive: true }); // Use passive: true for better scrolling performance

            siteCard.addEventListener('touchend', (e) => {
                clearTimeout(pressTimer);
                if (!isLongPress) {
                    // Slight delay to ensure click doesn't trigger if tap was part of scroll
                    setTimeout(() => {
                        window.open(site.url, '_blank');
                    }, 50);
                }
                isLongPress = false;
            });

            siteCard.addEventListener('touchcancel', () => {
                clearTimeout(pressTimer);
                isLongPress = false;
            });

            // Right-click (context menu) for desktop to show actions
            siteCard.addEventListener('contextmenu', (e) => {
                e.preventDefault(); // Prevent default browser context menu
                hideAllSiteActions(); // Hide other actions
                siteCard.classList.add('show-actions'); // Show actions for THIS card
            });


            return siteCard;
        }

        // Hides actions for a specific card
        function hideSiteActions(cardElement) {
            cardElement.classList.remove('show-actions');
        }

        // Hides actions for all cards
        function hideAllSiteActions() {
            document.querySelectorAll('.site-card.show-actions').forEach(card => {
                card.classList.remove('show-actions');
            });
        }


        // Adiciona um novo site
        function addSite() {
            const name = siteNameInput.value.trim();
            let url = siteUrlInput.value.trim();
            const category = siteCategoryInput.value;

            if (!name || !url) {
                showNotification('Por favor, preencha o nome e a URL do site.', 'error');
                return;
            }

            // Valida√ß√£o de URL
            try {
                // Prepend https:// if no protocol is found
                if (!url.startsWith('http://') && !url.startsWith('https://')) {
                    url = 'https://' + url;
                }
                const tempUrl = new URL(url); // Validate URL format
                url = tempUrl.href; // Use the canonical URL
            } catch (e) {
                showNotification('URL inv√°lida. Por favor, insira um formato correto (Ex: https://example.com).', 'error');
                return;
            }

            const site = { 
                id: 'site-' + Date.now() + Math.floor(Math.random() * 1000),
                name, 
                url, 
                category,
                createdAt: new Date().toISOString(),
                pinned: false
            };

            // Verifica se o site j√° existe
            if (currentSites.some(s => s.url === site.url)) {
                showNotification('Este site j√° est√° na sua lista!', 'warning');
                return;
            }

            currentSites.unshift(site); // Adiciona no in√≠cio do array
            saveAllSites();
            renderAllSites(); // Re-render to show new site and apply filters/search
            
            showNotification(`Site "${name}" adicionado com sucesso!`, 'success');
            updateStats();
            
            // Limpa o formul√°rio
            siteNameInput.value = '';
            siteUrlInput.value = '';
            siteNameInput.focus();
        }

        // Remove um site
        function removeSite(siteId, cardElement) {
            // Anima√ß√£o de sa√≠da
            cardElement.classList.add('fade-out');
            
            cardElement.addEventListener('animationend', () => {
                currentSites = currentSites.filter(site => site.id !== siteId);
                saveAllSites();
                renderAllSites(); // Re-render all to update grids
                showNotification('Site removido com sucesso!', 'info');
                updateStats();
            }, { once: true });
        }

        // Alterna o estado "fixado" de um site
        function togglePinSite(siteId) {
            const siteIndex = currentSites.findIndex(site => site.id === siteId);
            if (siteIndex !== -1) {
                currentSites[siteIndex].pinned = !currentSites[siteIndex].pinned;
                saveAllSites();
                renderAllSites(); // Re-render all to update grids
                
                const action = currentSites[siteIndex].pinned ? 'fixado' : 'desfixado';
                showNotification(`Site ${action} com sucesso!`, 'info');
                updateStats();
            }
        }

        // Abre o modal de edi√ß√£o
        function openEditModal(site) {
            editNameInput.value = site.name;
            editUrlInput.value = site.url;
            editCategoryInput.value = site.category || 'geral';
            editSiteIdInput.value = site.id;
            editSiteId = site.id;
            
            editModal.classList.add('active');
            document.body.style.overflow = 'hidden'; // Impede scroll da p√°gina
        }

        // Fecha o modal
        function closeModal() {
            editModal.classList.remove('active');
            document.body.style.overflow = '';
        }

        // Salva as altera√ß√µes do site editado
        function saveEditedSite() {
            const name = editNameInput.value.trim();
            let url = editUrlInput.value.trim();
            const category = editCategoryInput.value;

            if (!name || !url) {
                showNotification('Por favor, preencha o nome e a URL do site.', 'error');
                return;
            }

            // Valida√ß√£o de URL
            try {
                // Prepend https:// if no protocol is found
                if (!url.startsWith('http://') && !url.startsWith('https://')) {
                    url = 'https://' + url;
                }
                const tempUrl = new URL(url); // Validate URL format
                url = tempUrl.href; // Use the canonical URL
            } catch (e) {
                showNotification('URL inv√°lida. Por favor, insira um formato correto (Ex: https://example.com).', 'error');
                return;
            }

            const siteIndex = currentSites.findIndex(site => site.id === editSiteId);
            if (siteIndex !== -1) {
                currentSites[siteIndex].name = name;
                currentSites[siteIndex].url = url;
                currentSites[siteIndex].category = category;
                
                saveAllSites();
                renderAllSites(); // Re-render to update grids
                closeModal();
                
                showNotification('Site atualizado com sucesso!', 'success');
                updateStats();
            }
        }

        // Filtra os sites por categoria e pesquisa
        function filterSites() {
            // First, filter all sites based on current search and category
            let allVisibleSites = [...currentSites];
            
            // Filter by search
            if (currentSearch) {
                allVisibleSites = allVisibleSites.filter(site => 
                    site.name.toLowerCase().includes(currentSearch) || 
                    site.url.toLowerCase().includes(currentSearch) ||
                    getCategoryName(site.category || 'geral').toLowerCase().includes(currentSearch) // Search by category name too
                );
            }

            // Separate pinned sites (always shown at the top)
            const pinnedSites = allVisibleSites.filter(site => site.pinned);
            if (pinnedSites.length > 0) {
                renderSites(pinnedSites, pinnedSitesContainer);
                pinnedContainer.style.display = 'block';
            } else {
                pinnedSitesContainer.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-thumbtack"></i>
                        <p>Nenhum site fixado ainda. Pressione e segure em um site para ver as a√ß√µes e fixar.</p>
                    </div>
                `;
                pinnedContainer.style.display = 'block'; // Keep the container visible to show the empty state
            }

            // Filter remaining (non-pinned) sites by category
            let nonPinnedAndFilteredSites = allVisibleSites.filter(site => !site.pinned);

            if (currentFilter !== 'all') {
                nonPinnedAndFilteredSites = nonPinnedAndFilteredSites.filter(site => 
                    (site.category || 'geral') === currentFilter
                );
            }
            
            renderSites(nonPinnedAndFilteredSites, sitesContainer, true); // Pass true for filtered empty state message
        }

        // Salva todos os sites no localStorage
        function saveAllSites() {
            localStorage.setItem('mySites', JSON.stringify(currentSites));
        }

        // Mostra uma notifica√ß√£o
        function showNotification(message, type = 'info', duration = 3000) {
            const notification = document.createElement('div');
            notification.classList.add('notification', `notification-${type}`);
            
            let icon;
            switch(type) {
                case 'success': icon = 'fa-check-circle'; break;
                case 'error': icon = 'fa-exclamation-circle'; break;
                case 'warning': icon = 'fa-exclamation-triangle'; break;
                default: icon = 'fa-info-circle';
            }
            
            notification.innerHTML = `
                <i class="fas ${icon}"></i>
                <span>${message}</span>
            `;
            
            notificationContainer.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, duration + 500); // Give it a little extra time for the fadeOut animation
        }

        // Alterna entre temas dark/light
        function toggleTheme() {
            if (document.body.classList.contains('dark-theme')) {
                document.body.classList.remove('dark-theme');
                document.body.classList.add('light-theme');
                localStorage.setItem('theme', 'light');
                updateThemeToggle('light');
            } else {
                document.body.classList.remove('light-theme');
                document.body.classList.add('dark-theme');
                localStorage.setItem('theme', 'dark');
                updateThemeToggle('dark');
            }
        }

        // Atualiza o √≠cone do bot√£o de tema
        function updateThemeToggle(theme) {
            const icon = theme === 'dark' ? 'fa-sun' : 'fa-moon';
            themeToggle.innerHTML = `<i class="fas ${icon}"></i>`;
        }

        // Atualiza as estat√≠sticas
        function updateStats() {
            totalSitesEl.textContent = currentSites.length;
            
            const pinnedCount = currentSites.filter(site => site.pinned).length;
            pinnedSitesCountEl.textContent = pinnedCount; // Corrected ID
            
            // Conta categorias √∫nicas
            const categories = new Set(currentSites.map(site => site.category || 'geral'));
            categoriesCountEl.textContent = categories.size;
            
            // √öltimo site adicionado
            if (currentSites.length > 0) {
                // Sort by createdAt descending to find the latest
                const sortedSites = [...currentSites].sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt));
                lastAddedEl.textContent = sortedSites[0].name;
            } else {
                lastAddedEl.textContent = '-';
            }
        }

        // Retorna o nome amig√°vel da categoria
        function getCategoryName(category) {
            const names = {
                'geral': 'Geral',
                'trabalho': 'Trabalho',
                'estudo': 'Estudo',
                'entretenimento': 'Entretenimento',
                'redes-sociais': 'Redes Sociais',
                'outros': 'Outros'
            };
            return names[category] || category; // Fallback to category itself if not found
        }
    </script>
</body>
</html>
